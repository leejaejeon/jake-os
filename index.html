<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Jake WorkOS V15 - Absolute Master Map</title>
  
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css');
    body { font-family: 'Pretendard', sans-serif; background-color: #f1f5f9; color: #1e293b; -webkit-font-smoothing: antialiased; overflow: hidden; }
    
    /* ìŠ¤í¬ë¡¤ë°” ë””ìì¸ */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #f8fafc; border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; border: 2px solid #f8fafc; }
    ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    /* ëŒ€ì‹œë³´ë“œ ë‹¬ë ¥ */
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background-color: #e2e8f0; border: 1px solid #e2e8f0; }
    .calendar-cell { min-height: 110px; background-color: #fff; padding: 4px; transition: background 0.2s; cursor: pointer; }
    .calendar-cell:hover { background-color: #f8fafc; }
    
    /* ëª¨ë‹¬ ì• ë‹ˆë©”ì´ì…˜ */
    .modal-enter { animation: fadeIn 0.2s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* ğŸ—ºï¸ í˜„ì‹¤ ì§€ë„ ë¬¼ë¦¬ ì—”ì§„ */
    /* flex-startë¥¼ ìœ ì§€í•˜ì—¬ B1/ê°€ ê°™ì€ ë¶ˆê·œì¹™ ë¼ì¸ì˜ ìš°ì¸¡ì— ìì—°ìŠ¤ëŸ¬ìš´ ë¹ˆ ê³µê°„ ìƒì„± */
    .map-row { display: flex; flex-direction: row; justify-content: flex-start; gap: 4px; margin-bottom: 4px; width: max-content; }
    .map-slot { width: 85px; min-width: 85px; height: 70px; border-radius: 6px; border: 1px solid #cbd5e1; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; transition: transform 0.1s, opacity 0.1s; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    .map-slot:active { transform: scale(0.95); opacity: 0.8; }
    .slot-spacer { visibility: hidden; pointer-events: none; border: none; background: transparent; box-shadow: none; } 
    .slot-id { font-size: 10px; opacity: 0.8; font-weight: 800; margin-bottom: 2px; }
    .slot-name { font-size: 11px; font-weight: 800; text-align: center; width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 2px; letter-spacing: -0.5px; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;

    const SUPABASE_URL = 'https://lqccxnciiajwqdmpwjdv.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxxY2N4bmNpaWFqd3FkbXB3amR2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1MjA3MTMsImV4cCI6MjA4NzA5NjcxM30.L23-eq-DIPsbONOeX-xQ8UcMb7gtgTTTRpkaSm9HTw4';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const clean = (val) => (!val || val === '0.0' || val === '0' || val === 'null' || val === ' -  - ') ? '' : String(val).trim();
    const normalizeDate = (v) => { 
      if(!v) return null; 
      const s = String(v).replace(/\./g,'-').replace(/\s/g,'').substring(0,10);
      const match = s.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/);
      return match ? `${match[1]}-${match[2].padStart(2, '0')}-${match[3].padStart(2, '0')}` : null;
    };
    const formatMoney = (val) => {
      const num = parseInt(String(val).replace(/[^0-9]/g, ''));
      return isNaN(num) ? '0ì›' : num.toLocaleString() + 'ì›';
    };

    // ğŸš€ ì••ì¶•ëœ ì ˆëŒ€ ì¢Œí‘œ ë„ë©´ (Excel ì›ë³¸ ì™„ë²½ ë³µì œ)
    const COMPRESSED_LAYOUTS = {"A2/ê°€":["1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1"],"A3/ê°€":["1-7","1-6","1-5","1-4","1-3-2","1-3-1","1-2","1-1","2-7","2-6","2-5","2-4","2-3","2-2","2-1","2-1A"],"A4/ê°€":["_6","1-6","1-5","1-4","1-3","1-2","1-1","_9","2-1","_2","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-12-2","5-12-1","5-11-2","5-11-1","5-10-2","5-10-1","5-9-2","5-9-1","5-8-2","5-8-1","5-7-2","5-7-1","5-6","5-5","5-4","5-3","5-2","5-1","5-12-4","5-12-3","5-11-4","5-11-3","5-10-4","5-10-3","5-9-4","5-9-3","5-8-4","5-8-3","5-7-4","5-7-3","_6","5-12-8","5-12-7","5-12-6","5-12-5","5-11-8","5-11-7","5-11-6","5-11-5","5-10-8","5-10-7","5-10-6","5-10-5","5-9-8","5-9-7","5-9-6","5-9-5","5-8-8","5-8-7","5-8-6","5-8-5","_8","6-5","6-4","6-3","6-2","6-1","_7"],"A4/ë‚˜":["1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-8","5-7","5-6","5-5","5-4","5-3","5-2","5-1"],"A4/ë‹¤":["4-6","4-5","4-4","4-3","4-2","4-1","5-6","5-5","5-4","5-3","5-2","5-1"],"A5/ê°€":["1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-13","5-12","5-11","5-10","5-9","5-8","5-7","5-6","5-5","5-4","5-3","5-2","5-1","6-11","6-10","6-9","6-8","6-7","6-6","6-5","6-4","6-3","6-2","6-1C","6-1B","6-1A","6-0","6-1M","8-8","8-7","8-6","8-5","8-4","8-3","8-2","8-1","8-1C","8-1B","8-1A"],"A5/ë‚˜":["_9","1-14","1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-22","2-21","2-20","2-19","2-18","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-26","3-25","3-24","3-23","3-22","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-29","5-28","5-27","5-26","5-25","5-24","5-23","5-22","5-21","5-20","5-19","5-18","5-17","5-16","5-15","5-14","5-13","5-12","5-11","5-10","5-9","5-8","5-7A","5-7","5-6","5-5","5-4","5-3","5-2","5-1","6-47","6-46","6-45","6-44","6-43","6-42","6-41","6-40","6-39","6-38","6-37","6-36","6-35","6-34","6-33","6-32","6-31","6-30","6-29-1","6-28-1","6-27-1","6-26-1","6-25-1","6-24-1","6-23-1","6-22-1","6-21-1","6-20-1","6-19-1","6-18-1","6-17-1","6-16-1","6-15-1","6-14-1","6-13-1","6-12-1","6-11-1","6-10-1","6-9-1","6-8-1","6-7-1","6-6-1","6-5-1","6-4-1","6-3-1","6-2-1","6-1-1","_18","6-29-2","6-28-2","6-27-2","6-26-2","6-25-2","6-24-2","6-23-2","6-22-2","6-21-2","6-20-2","6-19-2","6-18-2","6-17-2","6-16-2","6-15-2","6-14-2","6-13-2","6-12-2","6-11-2","6-10-2","6-9-2","6-8-2","6-7-2","6-6-2","6-5-2","6-4-2","6-3-2","6-2-2","6-1-2","_18","6-29-3","6-28-3","6-27-3","6-26-3","6-25-3","6-24-3","6-23-3","6-22-3","6-21-3","6-20-3","6-19-3","6-18-3","_17","7-9","7-8","7-7","7-6","7-5","7-4","7-3","7-2","7-1","_30"],"A6/ê°€":["1-23","1-22","1-21","1-20","1-19","1-18","1-17","1-16-2","1-16-1","1-15","1-14-2","1-14-1","1-13","1-12","1-11","1-10","1-9-2","1-9-1","1-8","1-7","1-6","1-5-2","1-5-1","1-4","1-3","1-2","1-1","2-22","2-21","2-20","2-19-2","2-19-1","2-18","2-17-2","2-17-1","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8-2","2-8-1","2-7","2-6-2","2-6-1","2-5","2-4","2-3","2-2","2-1-2","2-1-1","_2","3-19-2","3-19-1","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-18","5-17","5-16","5-15","5-14","5-13","5-12","5-11","5-10","5-9","5-8","5-7","5-6","5-5-2","5-5-1","5-4","5-3","5-2","5-1","6-15","6-14","6-13","6-12","6-11","6-10","6-9","6-8","6-7","6-6","6-5","6-4","6-3","6-2","6-1","7-13","7-12","7-11","7-10","7-9","7-8","7-7","7-6","7-5","7-4","7-3","7-2","7-1"],"A6/ë‚˜":["1-25","1-24","1-23","1-22","1-21","1-20","1-19","1-18","1-17","1-16","1-15","1-14","1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-26","2-25","2-24","2-23","2-22","2-21","2-20","2-19","2-18","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-26","3-25","3-24","3-23","3-22","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-26","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-14","5-13","5-12-1","5-12-2","5-11-1","5-11-2","5-10-1","5-10-2","5-9-1","5-9-2","5-8-1","5-8-2","5-7-1","5-7-2","5-6-1","5-6-2","5-5-1","5-5-2","5-4-1","5-4-2","5-3-1","5-3-2","5-2-1","5-2-2","5-1-1","5-1-2","_4","5-11-3","5-11-4","5-10-3","5-10-4","5-9-3","5-9-4","5-8-3","5-8-4","5-7-3","5-7-4","5-6-3","_1","5-5-3","5-5-4","5-4-3","5-4-4","5-3-3","5-3-4","5-2-3","5-2-4","5-1-3","5-1-4"],"C1/ê°€":["1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1"],"B1/ê°€":["1-20","1-19","1-18","1-17","1-16","1-15","1-14","1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-23","2-22","2-21","2-20","2-19","2-18","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1"],"B2/ê°€":["1-5","1-4","1-3","1-2","1-1","_29","2-4","2-3","2-2","2-1","_30","3-35","3-34","3-33","3-32","3-31","3-30","3-29","3-28","3-27","3-26","3-25","3-24","3-23","3-22","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-34","4-33","4-32","4-31","4-30","4-29","4-28","4-27","4-26","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-34","5-33","5-32","5-31","5-30","5-29","5-28","5-27","5-26","5-25","5-24","5-23","5-22","5-21","5-20","5-19","5-18","5-17","5-16","5-15","5-14","5-13","5-12","5-11","5-10","5-9","5-8","5-7","5-6","5-5","5-4","5-3","5-2","5-1"],"B3/ê°€":["1-48","1-47","1-46","1-45","1-44","1-43","1-42","1-41","1-40","1-39","1-38","1-37","1-36","1-35","1-34","1-33","1-32","1-31","1-30","1-29","1-28","1-27","1-26","1-25","1-24","1-23","1-22","1-21","1-20","1-19","1-18","1-17","1-16","1-15","1-14","1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-46","2-45","2-44","2-43","2-42","2-41","2-40","2-39","2-38","2-37","2-36","2-35","2-34","2-33","2-32","2-31","2-30","2-29","2-28","2-27","2-26","2-25","2-24","2-23","2-22","2-21","2-20","2-19","2-18","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-45","3-44","3-43","3-42","3-41","3-40","3-39","3-38","3-37","3-36","3-35","3-34","3-33","3-32","3-31","3-30","3-29","3-28","3-27","3-26","3-25","3-24","3-23","3-22","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-41","4-40","4-39","4-38","4-37","4-36","4-35","4-34","4-33","4-32","4-31","4-30","4-29","4-28","4-27","4-26","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1"],"B4/ê°€":["1-37","1-36","1-35","1-34","1-33","1-32","1-31","1-30","1-29","1-28","1-27","1-26","1-25","1-24","1-23","1-22","1-21","1-20","1-19","1-18","1-17","1-16","1-15","1-14","1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-38","2-37","2-36","2-35","2-34","2-33","2-32","2-31","2-30","2-29","2-28","2-27","2-26","2-25","2-24","2-23","2-22","2-21","2-20","2-19","2-18","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-41","3-40","3-39","3-38","3-37","3-36","3-35","3-34","3-33","3-32","3-31","3-30","3-29","3-28","3-27","3-26","3-25","3-24","3-23","3-22","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-41","4-40","4-39","4-38","4-37","4-36","4-35","4-34","4-33","4-32","4-31","4-30","4-29","4-28","4-27","4-26","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-34","5-33","5-32","5-31","5-30","5-29","5-28","5-27","5-26","5-25","5-24","5-23","5-22","5-21","5-20","5-19","5-18","5-17","5-16","5-15","5-14","5-13","5-12","5-11","5-10","5-9","5-8","5-7","5-6","5-5","5-4","5-3","5-2","5-1"],"B5/ê°€":["1-47","1-46","1-45","1-44","1-43","1-42","1-41","1-40","1-39","1-38","1-37","1-36","1-35","1-34","1-33","1-32","1-31","1-30","1-29","1-28","1-27","1-26","1-25","1-24","1-23","1-22","1-21","1-20","1-19","1-18","1-17","1-16","1-15","1-14","1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-47","2-46","2-45","2-44","2-43","2-42","2-41","2-40","2-39","2-38","2-37","2-36","2-35","2-34","2-33","2-32","2-31","2-30","2-29","2-28","2-27","2-26","2-25","2-24","2-23","2-22","2-21","2-20","2-19","2-18","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-49","3-48","3-47","3-46","3-45","3-44","3-43","3-42","3-41","3-40","3-39","3-38","3-37","3-36","3-35","3-34","3-33","3-32","3-31","3-30","3-29","3-28","3-27","3-26","3-25","3-24","3-23","3-22","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-48","4-47","4-46","4-45","4-44","4-43","4-42","4-41","4-40","4-39","4-38","4-37","4-36","4-35","4-34","4-33","4-32","4-31","4-30","4-29","4-28","4-27","4-26","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-40","5-39","5-38","5-37","5-36","5-35","5-34","5-33","5-32","5-31","5-30","5-29","5-28","5-27","5-26","5-25","5-24","5-23","5-22","5-21","5-20","5-19","5-18","5-17","5-16","5-15","5-14","5-13","5-12","5-11","5-10","5-9","5-8","5-7","5-6","5-5","5-4","5-3","5-2","5-1","6-30","6-29-2","6-29-1","6-28","6-27","6-26","6-25","6-24-2","6-24-1","6-23","6-22","6-21","6-20","6-19","6-18","6-17","6-16","6-15","6-14","6-13","6-12","6-11","6-10","6-9","6-8","6-7","6-6","6-5","6-4","6-3","6-2","6-1"],"B6/ê°€/1-12":["1-47","1-46","1-45","1-44","1-43","1-42","1-41","1-40","1-39","1-38","1-37","1-36","1-35","1-34","1-33","1-32","1-31","1-30","1-29","1-28","1-27","1-26","1-25","1-24","1-23","1-22","1-21","1-20","1-19","1-18","1-17","1-16","1-15","1-14","1-13","1-12","1-11","1-10","1-9","1-8","1-7","1-6","1-5","1-4","1-3","1-2","1-1","2-52","2-51","2-50","2-49","2-48","2-47","2-46","2-45","2-44","2-43","2-42","2-41","2-40","2-39","2-38","2-37","2-36","2-35","2-34","2-33","2-32","2-31","2-30","2-29","2-28","2-27","2-26","2-25","2-24","2-23","2-22","2-21","2-20","2-19","2-18","2-17","2-16","2-15","2-14","2-13","2-12","2-11","2-10","2-9","2-8","2-7","2-6","2-5","2-4","2-3","2-2","2-1","3-53","3-52","3-51","3-50","3-49","3-48","3-47","3-46","3-45","3-44","3-43","3-42","3-41","3-40","3-39","3-38","3-37","3-36","3-35","3-34","3-33","3-32","3-31","3-30","3-29","3-28","3-27","3-26","3-25","3-24","3-23","3-22","3-21","3-20","3-19","3-18","3-17","3-16","3-15","3-14","3-13","3-12","3-11","3-10","3-9","3-8","3-7","3-6","3-5","3-4","3-3","3-2","3-1","4-52","4-51","4-50","4-49","4-48","4-47","4-46","4-45","4-44","4-43","4-42","4-41","4-40","4-39","4-38","4-37","4-36","4-35","4-34","4-33","4-32","4-31","4-30","4-29","4-28","4-27","4-26","4-25","4-24","4-23","4-22","4-21","4-20","4-19","4-18","4-17","4-16","4-15","4-14","4-13","4-12","4-11","4-10","4-9","4-8","4-7","4-6","4-5","4-4","4-3","4-2","4-1","5-53","5-52","5-51","5-50","5-49","5-48","5-47","5-46","5-45","5-44","5-43","5-42","5-41","5-40","5-39","5-38","5-37","5-36","5-35","5-34","5-33","5-32","5-31","5-30","5-29","5-28","5-27","5-26","5-25","5-24","5-23","5-22","5-21","5-20","5-19","5-18","5-17","5-16","5-15","5-14","5-13","5-12","5-11","5-10","5-9","5-8","5-7","5-6","5-5","5-4","5-3","5-2","5-1","6-53","6-52","6-51","6-50","6-49","6-48","6-47","6-46","6-45","6-44","6-43","6-42","6-41","6-40","6-39","6-38","6-37","6-36","6-35","6-34","6-33","6-32","6-31","6-30","6-29","6-28","6-27","6-26","6-25","6-24","6-23","6-22","6-21","6-20","6-19","6-18","6-17","6-16","6-15","6-14","6-13","6-12","6-11","6-10","6-9","6-8","6-7","6-6","6-5","6-4","6-3","6-2","6-1","6-107","6-106","6-105","6-104","6-103","6-102","6-101","6-100","6-99","6-98","6-97","6-96","6-95","6-94","6-93","6-92","6-91","6-90","6-89","6-88","6-87","6-86","6-85","6-84","6-83","6-82","6-81","6-80","6-79","6-78","6-77","6-76","6-75","6-74","6-73","6-72","6-71","6-70","6-69","6-68","6-67","6-66","6-65","6-64","6-63","6-62","6-61","6-60","6-59","6-58","6-57","6-56","6-55","6-54","7-54","7-53","7-52","7-51","7-50","7-49","7-48","7-47","7-46","7-45","7-44","7-43","7-42","7-41","7-40","7-39","7-38","7-37","7-36","7-35","7-34","7-33","7-32","7-31","7-30","7-29","7-28","7-27","7-26","7-25","7-24","7-23","7-22","7-21","7-20","7-19","7-18","7-17","7-16","7-15","7-14","7-13","7-12","7-11","7-10","7-9","7-8","7-7","7-6","7-5","7-4","7-3","7-2","7-1","8-54","8-53","8-52","8-51","8-50","8-49","8-48","8-47","8-46","8-45","8-44","8-43","8-42","8-41","8-40","8-39","8-38","8-37","8-36","8-35","8-34","8-33","8-32","8-31","8-30","8-29","8-28","8-27","8-26","8-25","8-24","8-23","8-22","8-21","8-20","8-19","8-18","8-17","8-16","8-15","8-14","8-13","8-12","8-11","8-10","8-9","8-8","8-7","8-6","8-5","8-4","8-3","8-2","8-1","9-53","9-52","9-51","9-50","9-49","9-48","9-47","9-46","9-45","9-44","9-43","9-42","9-41","9-40","9-39","9-38","9-37","9-36","9-35","9-34","9-33","9-32","9-31","9-30","9-29","9-28","9-27","9-26","9-25","9-24","9-23","9-22","9-21","9-20","9-19","9-18","9-17","9-16","9-15","9-14","9-13","9-12","9-11","9-10","9-9","9-8","9-7","9-6","9-5","9-4","9-3","9-2","9-1","10-55","10-54","10-53","10-52","10-51","10-50","10-49","10-48","10-47","10-46","10-45","10-44","10-43","10-42","10-41","10-40","10-39","10-38","10-37","10-36","10-35","10-34","10-33","10-32","10-31","10-30","10-29","10-28","10-27","10-26","10-25","10-24","10-23","10-22","10-21","10-20","10-19","10-18","10-17","10-16","10-15","10-14","10-13","10-12","10-11","10-10","10-9","10-8","10-7","10-6","10-5","10-4","10-3","10-2","10-1","11-54","11-53","11-52","11-51","11-50","11-49","11-48","11-47","11-46","11-45","11-44","11-43","11-42","11-41","11-40","11-39","11-38","11-37","11-36","11-35","11-34","11-33","11-32","11-31","11-30","11-29","11-28","11-27","11-26","11-25","11-24","11-23","11-22","11-21","11-20","11-19","11-18","11-17","11-16","11-15","11-14","11-13","11-12","11-11","11-10","11-9","11-8","11-7","11-6","11-5","11-4","11-3","11-2","11-1","12-50","12-49","12-48","12-47","12-46","12-45","12-44","12-43","12-42","12-41","12-40","12-39","12-38","12-37","12-36","12-35","12-34","12-33","12-32","12-31","12-30","12-29","12-28","12-27","12-26","12-25","12-24","12-23","12-22","12-21","12-20","12-19","12-18","12-17","12-16","12-15","12-14","12-13","12-12","12-11","12-10","12-9","12-8","12-7","12-6","12-5","12-4","12-3","12-2","12-1"],"B6/ê°€/13-14":["13-38-2","13-38-1","13-37-2","13-37-1","13-36-2","13-36-1","13-35-2","13-35-1","13-34-2","13-34-1","13-33-2","13-33-1","13-32-2","13-32-1","13-31-2","13-31-1","13-30-2","13-30-1","13-29-2","13-29-1","13-28-2","13-28-1","13-27-2","13-27-1","13-26-2","13-26-1","13-25-2","13-25-1","13-24-2","13-24-1","13-23-2","13-23-1","13-22-2","13-22-1","13-21-2","13-21-1","13-20-2","13-20-1","13-19-2","13-19-1","13-18-2","13-18-1","13-17-2","13-17-1","13-16-2","13-16-1","13-15-2","13-15-1","13-14-2","13-14-1","13-13-2","13-13-1","13-12-2","13-12-1","13-11-2","13-11-1","13-10-2","13-10-1","13-9-2","13-9-1","13-8-2","13-8-1","13-7-2","13-7-1","13-6-2","13-6-1","13-5","13-4-2","13-4-1","13-3-2","13-3-1","13-2-2","13-2-1","13-1-2","13-1-1","13-38-4","13-38-3","13-37-4","13-37-3","13-36-4","13-36-3","13-35-4","13-35-3","13-34-4","13-34-3","13-33-4","13-33-3","13-32-4","13-32-3","13-31-4","13-31-3","13-30-4","13-30-3","13-29-4","13-29-3","13-28-4","13-28-3","13-27-4","13-27-3","13-26-4","13-26-3","13-25-4","13-25-3","13-24-4","13-24-3","13-23-4","13-23-3","13-22-4","13-22-3","13-21-4","13-21-3","13-20-4","13-20-3","13-19-4","13-19-3","13-18-4","13-18-3","13-17-4","13-17-3","13-16-4","13-16-3","13-15-4","13-15-3","13-14-4","13-14-3","13-13-4","13-13-3","13-12-4","13-12-3","13-11-4","13-11-3","13-10-4","13-10-3","13-9-4","13-9-3","13-8-4","13-8-3","13-7-4","13-7-3","13-6-4","13-6-3","_9","13-38-6","13-38-5","13-37-6","13-37-5","13-36-6","13-36-5","13-35-6","13-35-5","13-34-6","13-34-5","13-33-6","13-33-5","13-32-6","13-32-5","13-31-6","13-31-5","13-30-6","13-30-5","13-29-6","13-29-5","13-28-6","13-28-5","13-27-6","13-27-5","13-26-6","13-26-5","13-25-6","13-25-5","13-24-6","13-24-5","13-23-6","13-23-5","13-22-6","13-22-5","13-21-6","13-21-5","13-20-6","13-20-5","13-19-6","13-19-5","13-18-6","13-18-5","13-17-6","13-17-5","13-16-6","13-16-5","13-15-6","13-15-5","13-14-6","13-14-5","13-13-6","13-13-5","_23","14-19-2","14-19-1","14-18-2","14-18-1","14-17-2","14-17-1","14-16-2","14-16-1","14-15-2","14-15-1","14-14-2","14-14-1","14-13-2","14-13-1","14-12-2","14-12-1","14-11-2","14-11-1","14-10-2","14-10-1","14-9-2","14-9-1","14-8-2","14-8-1","14-7-2","14-7-1","14-6-2","14-6-1","14-5-2","14-5-1","14-4-2","14-4-1","14-3-2","14-3-1","14-2-2","14-2-1","14-1-2","14-1-1","_37","14-19-5","14-19-4","14-19-3","14-18-4","14-18-3","14-17-4","14-17-3","14-16-4","14-16-3","14-15-4","14-15-3","14-14-4","14-14-3","14-13-4","14-13-3","14-12-4","14-12-3","14-11-4","14-11-3","14-10-4","14-10-3","14-9-4","14-9-3","14-8-4","14-8-3","14-7-4","14-7-3","14-6-4","14-6-3","14-5-4","14-5-3","_44","14-19-8","14-19-7","14-19-6","14-18-6","14-18-5","14-17-6","14-17-5","14-16-6","14-16-5","14-15-6","14-15-5","14-14-6","14-14-5","14-13-6","14-13-5","14-12-6","14-12-5","14-11-6","14-11-5","14-10-6","14-10-5","_54","14-19-11","14-19-10","14-19-9","14-18-8","14-18-7","14-17-8","14-17-7","14-16-8","14-16-7","14-15-8","14-15-7","14-14-8","14-14-7","14-13-8","14-13-7","14-12-8","14-12-7","14-11-7","_57","14-19-14","14-19-13","14-19-12","14-18-10","14-18-9","14-17-10","14-17-9","14-16-10","14-16-9","14-15-10","14-15-9","14-14-10","14-14-9","14-13-10","14-13-9","14-12-9","_59","14-19-17","14-19-16","14-19-15","14-18-12","14-18-11","14-17-12","14-17-11","_68"]};

    const extractLayout = (area) => {
        const comp = COMPRESSED_LAYOUTS[area] || [];
        const flat = [];
        comp.forEach(item => {
            if (item.startsWith('_')) {
                const count = parseInt(item.substring(1)) || 1;
                for(let i=0; i<count; i++) flat.push('SPACER');
            } else {
                flat.push(item);
            }
        });
        
        const config = ROW_CONFIG[area] || [20];
        const rows = [];
        let idx = 0;
        config.forEach(cnt => {
            rows.push(flat.slice(idx, idx + cnt));
            idx += cnt;
        });
        return rows;
    };

    // ==========================================
    // ğŸ” View: Field Map (ğŸš€ í•˜ë“œì½”ë”© ê·¸ë¦¬ë“œ ì—”ì§„)
    // ==========================================
    function FieldView() {
      const [loading, setLoading] = useState(true);
      const [data, setData] = useState([]);
      const [area, setArea] = useState('A6/ê°€');
      const [slotModal, setSlotModal] = useState({ isOpen: false, data: null });

      useEffect(() => {
        const fetchField = async () => {
          setLoading(true);
          const res = await supabaseClient.from('field_data').select('*').eq('êµ¬ì—­', area);
          setData(res.data || []);
          setLoading(false);
        };
        fetchField();
      }, [area]);

      const renderedGrid = useMemo(() => {
        const dataMap = {};
        data.forEach(item => {
          if (item.ìœ„ì¹˜_ë²ˆí˜¸ && item.ìœ„ì¹˜_ë²ˆí˜¸ !== 'SPACER') {
            dataMap[item.ìœ„ì¹˜_ë²ˆí˜¸] = item;
          }
        });

        const rows = extractLayout(area);
        return rows.map((rowSlots, rIdx) => {
          return {
            rowNum: rIdx + 1,
            slots: rowSlots.map((slotId, sIdx) => {
              if (slotId === 'SPACER') return { type: 'spacer', id: `spacer-${rIdx}-${sIdx}` };
              const match = dataMap[slotId];
              if (match) return { type: 'data', ...match };
              return { type: 'data', ìœ„ì¹˜_ë²ˆí˜¸: slotId, êµ¬ì—­: area, ê³„ì•½_ìƒíƒœ: 'ë¯¸ë¶„ì–‘' };
            })
          };
        });
      }, [data, area]);

      return (
        <div className="space-y-4 max-w-7xl mx-auto flex flex-col h-[calc(100vh-100px)]">
          {/* âœ… íƒ­ ê°€ë¡œ ìŠ¤í¬ë¡¤ ì™„ë²½ ì ìš© */}
          <div className="flex gap-2 overflow-x-auto pb-2 no-scrollbar shrink-0 border-b border-slate-200">
            {SECTION_LIST.map(s => (
              <button key={s} onClick={() => setArea(s)} className={`px-4 py-2.5 rounded-t-xl font-bold text-[13px] whitespace-nowrap transition-all border-t border-l border-r shrink-0 ${area === s ? 'bg-white text-slate-900 border-slate-200 border-b-white translate-y-[1px]' : 'bg-slate-100 text-slate-500 border-transparent hover:bg-slate-200'}`}>
                {s}
              </button>
            ))}
          </div>

          <div className="bg-white p-4 md:p-8 rounded-b-2xl rounded-tr-2xl shadow-xl border border-slate-200 flex-1 overflow-auto relative">
            {loading ? (
              <div className="flex h-full items-center justify-center font-black text-slate-300 animate-pulse tracking-widest text-lg">MAP BUILDING...</div>
            ) : (
              <div className="w-max mx-auto pb-10 pr-10">
                {renderedGrid.map((row) => (
                  <div key={`row-${row.rowNum}`} className="map-row">
                    {/* âœ… ë¬´ì¡°ê±´ ì—‘ì…€ ì›ë³¸ ê·¸ëŒ€ë¡œ ë¿Œë¦¼ */}
                    {row.slots.map((s) => {
                      if (s.type === 'spacer') {
                        return <div key={s.id} className="map-slot slot-spacer"></div>;
                      }

                      const status = clean(s.ê³„ì•½_ìƒíƒœ) || 'ë¯¸ë¶„ì–‘';
                      const colors = {
                        'ì•ˆì¹˜': 'bg-emerald-700 text-white border-emerald-800',
                        'ì˜ˆì•½': 'bg-amber-300 text-amber-900 border-amber-400',
                        'ê³„ì•½ê¸ˆ': 'bg-amber-100 text-amber-800 border-amber-300',
                        'í™€ë”©': 'bg-rose-600 text-white border-rose-800',
                        'ë¯¸ë¶„ì–‘': 'bg-white text-slate-400 border-slate-300'
                      };
                      return (
                        <div key={s.id || s.ìœ„ì¹˜_ë²ˆí˜¸} onClick={() => setSlotModal({ isOpen: true, data: s })} className={`map-slot ${colors[status] || colors['ë¯¸ë¶„ì–‘']}`}>
                          <div className={`slot-id ${status==='ë¯¸ë¶„ì–‘'?'text-slate-400':'text-inherit'}`}>{s.ìœ„ì¹˜_ë²ˆí˜¸}</div>
                          <div className={`slot-name ${status==='ë¯¸ë¶„ì–‘'?'opacity-30':'opacity-100'}`}>{clean(s.ì„±í•¨) || clean(s.ê³„ì•½ì) || 'EMPTY'}</div>
                        </div>
                      );
                    })}
                  </div>
                ))}
              </div>
            )}
          </div>

          {/* ğŸ“ ìƒì„¸ ì •ë³´ ëª¨ë‹¬ */}
          <Modal isOpen={slotModal.isOpen} onClose={() => setSlotModal({ isOpen: false, data: null })} title={`ğŸ—ºï¸ ${slotModal.data?.êµ¬ì—­} ${slotModal.data?.ìœ„ì¹˜_ë²ˆí˜¸}`}>
            {slotModal.data && (
              <div className="space-y-3">
                <div className="flex justify-between items-center bg-slate-100 p-4 rounded-xl border border-slate-200 shadow-sm">
                  <div>
                    <p className="text-[10px] font-black text-slate-400">ì•ˆì¹˜ì (ì„±í•¨)</p>
                    <p className="text-xl font-black text-slate-800">{clean(slotModal.data.ì„±í•¨) || '-'}</p>
                  </div>
                  <div className="text-right">
                    <p className="text-[10px] font-black text-slate-400">í˜„ì¬ ìƒíƒœ</p>
                    <p className="text-lg font-black text-blue-600">{clean(slotModal.data.ê³„ì•½_ìƒíƒœ) || 'ë¯¸ë¶„ì–‘'}</p>
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-3">
                  <div className="bg-white p-3 rounded-xl border border-slate-200 shadow-sm">
                    <p className="text-[10px] font-black text-slate-400 mb-1">ê³„ì•½ì</p>
                    <p className="font-bold text-slate-800">{clean(slotModal.data.ê³„ì•½ì) || '-'}</p>
                  </div>
                  <div className="bg-white p-3 rounded-xl border border-slate-200 shadow-sm">
                    <p className="text-[10px] font-black text-slate-400 mb-1">ê¸°ìˆ˜</p>
                    <p className="font-bold text-slate-800">{clean(slotModal.data.ê¸°ìˆ˜) ? `${slotModal.data.ê¸°ìˆ˜}ê¸°` : '-'}</p>
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-3">
                  <div className="bg-white p-3 rounded-xl border border-slate-200 shadow-sm">
                    <p className="text-[10px] font-black text-slate-400 mb-1">ë¶„ì–‘ê°€</p>
                    <p className="font-bold text-amber-600">{formatMoney(slotModal.data.ê°€ê²©)}</p>
                  </div>
                  <div className="bg-white p-3 rounded-xl border border-slate-200 shadow-sm">
                    <p className="text-[10px] font-black text-slate-400 mb-1">ê´€ë¦¬ë¹„</p>
                    <p className="font-bold text-amber-600">{formatMoney(slotModal.data.ê´€ë¦¬ë¹„)}</p>
                  </div>
                </div>
                <div className="bg-white p-4 rounded-xl border border-slate-200 shadow-sm mt-2">
                  <p className="text-[10px] font-black text-slate-400 mb-2">ë¹„ê³  (í˜„ì¥ ë©”ëª¨)</p>
                  <p className="text-sm font-medium text-slate-600 whitespace-pre-wrap">{clean(slotModal.data.ë©”ëª¨) || 'ê¸°ë¡ëœ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>
                </div>
              </div>
            )}
          </Modal>
        </div>
      );
    }

    // ==========================================
    // âš™ï¸ Main Application Controller
    // ==========================================
    function App() {
      const [activeTab, setActiveTab] = useState('dash');
      const [isSidebarOpen, setIsSidebarOpen] = useState(false);

      return (
        <div className="flex h-screen overflow-hidden">
          {isSidebarOpen && <div className="fixed inset-0 bg-black/50 z-40 lg:hidden" onClick={() => setIsSidebarOpen(false)} />}
          <aside className={`fixed inset-y-0 left-0 z-50 w-64 bg-slate-900 text-slate-300 lg:static lg:translate-x-0 ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} transition-transform shadow-2xl lg:shadow-none`}>
            <div className="p-6 border-b border-slate-800 flex justify-between items-center">
              <h1 className="text-xl font-black text-white tracking-tighter">JAKE WorkOS <span className="text-xs bg-emerald-600 px-1.5 py-0.5 rounded ml-1 text-white">V15</span></h1>
              <button className="lg:hidden text-slate-400 font-bold" onClick={() => setIsSidebarOpen(false)}>âœ•</button>
            </div>
            <nav className="p-4 space-y-8 overflow-y-auto h-[calc(100vh-80px)] no-scrollbar">
              <div>
                <p className="text-[10px] font-black text-slate-500 mb-3 ml-2 uppercase tracking-widest">ê³µìœ ì•± (Team)</p>
                <div className="space-y-1">
                  <button onClick={() => {setActiveTab('dash'); setIsSidebarOpen(false);}} className={`w-full flex items-center px-4 py-3 rounded-xl font-bold text-sm transition-all ${activeTab === 'dash' ? 'bg-blue-600 text-white shadow-lg shadow-blue-900/50' : 'hover:bg-slate-800'}`}>ğŸ“Š í†µí•© ëŒ€ì‹œë³´ë“œ</button>
                  <button onClick={() => {setActiveTab('field'); setIsSidebarOpen(false);}} className={`w-full flex items-center px-4 py-3 rounded-xl font-bold text-sm transition-all ${activeTab === 'field' ? 'bg-blue-600 text-white shadow-lg shadow-blue-900/50' : 'hover:bg-slate-800'}`}>ğŸ” í˜„ì¥ê´€ë¦¬ (Map)</button>
                  <button className="w-full flex items-center px-4 py-3 rounded-xl font-bold text-sm text-slate-600 cursor-not-allowed">ğŸ–ï¸ ê·¼íƒœê´€ë¦¬ (ëŒ€ê¸°ì¤‘)</button>
                </div>
              </div>
              <div>
                <p className="text-[10px] font-black text-slate-500 mb-3 ml-2 uppercase tracking-widest">WorkOS (Jake)</p>
                <div className="space-y-1">
                  <button className="w-full flex items-center px-4 py-3 rounded-xl font-bold text-sm text-slate-600 cursor-not-allowed">ğŸš€ í”„ë¡œì íŠ¸ (ëŒ€ê¸°ì¤‘)</button>
                  <button className="w-full flex items-center px-4 py-3 rounded-xl font-bold text-sm text-slate-600 cursor-not-allowed">âš°ï¸ ê°ì¸ê´€ë¦¬ (ëŒ€ê¸°ì¤‘)</button>
                </div>
              </div>
            </nav>
          </aside>

          <main className="flex-1 flex flex-col h-screen overflow-hidden">
            <header className="h-14 bg-white border-b border-slate-200 flex items-center px-6 justify-between shrink-0 shadow-sm z-10">
              <div className="flex items-center">
                <button className="lg:hidden p-2 text-slate-500 bg-slate-100 rounded-lg mr-4" onClick={() => setIsSidebarOpen(true)}>â˜°</button>
                <h2 className="font-black text-lg text-slate-800 uppercase tracking-tighter">{activeTab === 'dash' ? 'Integrated Dashboard' : 'Field Management'}</h2>
              </div>
              <div className="flex items-center space-x-2">
                <span className="text-[10px] font-black text-slate-400 hidden sm:inline">DATA ALIGNED</span>
                <div className="h-2 w-2 rounded-full bg-emerald-500 animate-pulse"></div>
              </div>
            </header>
            <div className="flex-1 overflow-hidden bg-[#F8FAFC]">
              {activeTab === 'dash' && <DashboardView />}
              {activeTab === 'field' && <FieldView />}
            </div>
          </main>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
