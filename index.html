const fetchData = async () => {
        setLoading(true);
        try {
          // 1. 실제_안치일정이 비어있지 않은 모든 데이터를 일단 가져옵니다.
          const { data, error } = await supabaseClient
            .from('view_master_dashboard')
            .select('*')
            .not('실제_안치일정', 'is', null);

          if (error) throw error;
          
          // 2. 가져온 데이터 중 유효한 날짜 형식을 가진 것만 정리합니다.
          const validData = (data || []).map(item => ({
            ...item,
            normDate: formatDate(item.실제_안치일정) // YYYY-MM-DD 형식으로 통일
          })).filter(item => item.normDate !== null);

          setDataList(validData);
        } catch (error) { 
          console.error("데이터 매핑 에러:", error); 
        } finally { 
          setLoading(false); 
        }
      };

      const calendarDays = useMemo(() => {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        const firstDay = new Date(year, month, 1).getDay();
        const startOffset = firstDay === 0 ? 6 : firstDay - 1; 
        const lastDate = new Date(year, month + 1, 0).getDate();
        
        const days = [];
        for (let i = 0; i < startOffset; i++) days.push(null);
        for (let i = 1; i <= lastDate; i++) {
          const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
          // 3. 통일된 날짜(normDate)와 달력의 날짜(dateStr)를 비교합니다.
          const dayEvents = dataList.filter(row => row.normDate === dateStr);
          days.push({ day: i, dateStr, events: dayEvents });
        }
        return days;
      }, [currentDate, dataList]);
